# 页面设计快速参考

## 一、页面结构总览

```
小程序
├── TabBar 页面（底部导航）
│   ├── 工作台 (pages/index/index)
│   ├── 订单管理 (pages/order/index)
│   ├── 生产管理 (pages/production/index)
│   └── 我的 (pages/profile/index)
│
└── 功能页面
    ├── 订单相关
    │   ├── 创建订单 (pages/order/create)
    │   └── 订单详情 (pages/order/detail)
    ├── 生产相关
    │   ├── 任务详情 (pages/production/task)
    │   └── 进度上报 (pages/production/progress)
    ├── 产品管理 (pages/product/list)
    ├── 客户管理 (pages/customer/list)
    └── 库存管理 (pages/inventory/list)
```

---

## 二、各页面功能设计

### 2.1 工作台（首页）

**核心功能**：
- 数据概览卡片（4个）
  - 今日订单数
  - 今日产量
  - 今日销售额
  - 待处理事项数

- 待处理事项列表
  - 待审核订单（数量 + 跳转）
  - 待分配任务（数量 + 跳转）
  - 待质检任务（数量 + 跳转）

- 快捷入口（4个）
  - 新建订单
  - 生产计划
  - 库存查询
  - 员工管理

- 生产看板
  - 各车间实时状态
  - 当前任务数
  - 今日完成数

**数据来源**：
- `DashboardStats` 接口
- 实时刷新（每30秒）

---

### 2.2 订单管理

**列表页功能**：
- 顶部筛选栏
  - 状态筛选（全部/待审核/生产中/待发货/已完成）
  - 时间筛选（今天/本周/本月/自定义）
  - 搜索框（订单号/客户名/产品名）

- 订单卡片列表
  - 订单号
  - 客户名称
  - 产品名称 + 规格
  - 数量 + 单位
  - 交期
  - 状态标签（颜色区分）
  - 优先级标识（紧急/高/普通/低）

- 底部操作
  - 创建订单（浮动按钮）

**详情页功能**：
- 订单基本信息
- 客户信息
- 产品信息
- 生产进度（关联的生产任务）
- 质检记录
- 操作按钮（审核/排产/发货/取消）

---

### 2.3 生产管理

**列表页功能**：
- 状态筛选（待分配/进行中/已完成）
- 车间筛选
- 任务卡片
  - 任务编号
  - 关联订单号
  - 产品名称
  - 车间名称
  - 数量/进度
  - 计划时间
  - 负责人

**任务详情页**：
- 任务基本信息
- 生产进度（进度条 + 历史记录）
- 质检记录
- 操作按钮（分配/上报进度/质检）

---

### 2.4 我的

**功能模块**：
- 个人信息卡片
  - 头像
  - 姓名
  - 角色/职位
  - 所属车间

- 功能菜单（根据角色显示）
  - 我的任务（工人）
  - 我的订单（客户）
  - 客户管理（管理员）
  - 产品管理（管理员）
  - 库存管理（管理员）
  - 员工管理（管理员）
  - 数据统计（管理员/主管）

- 设置
  - 通知设置
  - 修改密码
  - 关于
  - 退出登录

---

## 三、数据设计要点

### 3.1 状态流转

**订单状态流转**：
```
草稿 → 待审核 → 已审核 → 已排产 → 生产中 → 质检中 → 待发货 → 已发货 → 已完成
  ↓                                                              ↓
取消                                                            取消
```

**任务状态流转**：
```
待分配 → 已分配 → 进行中 → 已完成 → 质检中 → 质检通过/不通过
```

### 3.2 权限控制

**页面级权限**：
- 使用 `Taro.getStorageSync('userRole')` 获取用户角色
- 根据角色显示/隐藏功能入口
- 路由守卫（跳转前检查权限）

**数据级权限**：
- 客户只能看到自己的订单
- 工人只能看到分配给自己的任务
- 管理员/主管可以看到全部数据

### 3.3 数据缓存策略

**需要缓存的数据**：
- 客户列表（1小时）
- 产品列表（1小时）
- 员工列表（1小时）
- 用户信息（永久）

**实时数据**：
- 订单列表（不缓存）
- 生产任务（不缓存）
- 首页统计（30秒刷新）

---

## 四、UI/UX 设计建议

### 4.1 颜色规范
- 主色：`#F08300`（橙色，代表活力）
- 成功：`#10B981`（绿色）
- 警告：`#F59E0B`（黄色）
- 错误：`#EF4444`（红色）
- 信息：`#3B82F6`（蓝色）

### 4.2 状态颜色
- 待审核：`#F59E0B`（黄色）
- 生产中：`#3B82F6`（蓝色）
- 已完成：`#10B981`（绿色）
- 已取消：`#94A3B8`（灰色）
- 紧急：`#EF4444`（红色）

### 4.3 交互设计
- 列表项点击进入详情
- 长按显示快捷操作菜单
- 下拉刷新列表
- 上拉加载更多
- 浮动按钮用于主要操作

---

## 五、开发优先级

### Phase 1: 核心功能（1-2周）
1. ✅ 首页数据展示
2. ✅ 订单列表和详情
3. ✅ 订单创建
4. ✅ 生产任务列表

### Phase 2: 生产流程（1-2周）
1. 任务分配
2. 进度上报
3. 质检管理
4. 状态流转

### Phase 3: 管理功能（1周）
1. 客户管理
2. 产品管理
3. 库存管理
4. 员工管理

### Phase 4: 高级功能（1周）
1. 数据统计报表
2. 消息通知
3. 权限管理
4. 数据导出

---

## 六、技术实现建议

### 6.1 状态管理
```typescript
// 使用 Context API 管理全局状态
interface AppState {
  user: Employee | null
  orders: Order[]
  tasks: ProductionTask[]
  // ...
}
```

### 6.2 数据请求
```typescript
// 使用 scope.requestWithLoadingAndPagination
const orders = await scope.requestWithLoadingAndPagination(
  '/api/order/list',
  { status: 'producing', pageNum: 1, pageSize: 10 }
)
```

### 6.3 图片上传
```typescript
// 使用 Taro.chooseImage
const res = await Taro.chooseImage({ count: 1 })
// 上传到服务器
const uploadRes = await Taro.uploadFile({
  url: '/api/upload',
  filePath: res.tempFilePaths[0],
  name: 'file'
})
```

### 6.4 表单验证
```typescript
// 使用 NutUI 的 Form 组件
import { Form, Input, Button } from '@nutui/nutui-react-taro'
```

---

## 七、注意事项

1. **性能优化**
   - 列表使用虚拟滚动（如果数据量大）
   - 图片懒加载
   - 合理使用缓存

2. **错误处理**
   - 网络错误提示
   - 数据为空状态
   - 加载失败重试

3. **用户体验**
   - 操作反馈（Toast）
   - 加载状态（Loading）
   - 确认对话框（危险操作）

4. **兼容性**
   - 测试不同机型
   - 适配不同屏幕尺寸
   - 处理微信小程序限制




